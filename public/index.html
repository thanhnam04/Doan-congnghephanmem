<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart School Bus Tracking System - SSB 1.0</title>
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            background: linear-gradient(135deg, #1e5799 0%, #207cca 100%);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li {
            margin-left: 1.5rem;
        }
        
        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: opacity 0.3s;
        }
        
        nav ul li a:hover {
            opacity: 0.8;
        }
        
        .hero {
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%231e5799" opacity="0.1"/></svg>');
            padding: 4rem 0;
            text-align: center;
        }
        
        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: #1e5799;
        }
        
        .hero p {
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto 2rem;
            color: #555;
        }
        
        .cta-button {
            display: inline-block;
            background: #1e5799;
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            transition: background 0.3s;
        }
        
        .cta-button:hover {
            background: #16457a;
        }
        
        .features {
            padding: 4rem 0;
            background-color: white;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 3rem;
            color: #1e5799;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }
        
        .feature-card {
            background: #f9f9f9;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
        }
        
        .feature-card h3 {
            color: #1e5799;
            margin-bottom: 1rem;
        }
        
        .feature-card ul {
            list-style-position: inside;
        }
        
        .feature-card ul li {
            margin-bottom: 0.5rem;
        }
        
        .demo {
            padding: 4rem 0;
            background-color: #f5f7fa;
        }
        
        .demo-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .bus-map {
            width: 100%;
            max-width: 800px;
            height: 400px;
            background: #e9ecef;
            border-radius: 8px;
            margin-bottom: 2rem;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #6c757d;
            font-size: 1.2rem;
        }
        
        .user-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .user-btn {
            padding: 0.7rem 1.5rem;
            border: none;
            border-radius: 5px;
            background: #1e5799;
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }
        
        .user-btn:hover {
            background: #16457a;
        }
        
        .user-btn.active {
            background: #0d2d54;
        }
        
        .user-panel {
            width: 100%;
            max-width: 800px;
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
        
        .panel-title {
            margin-bottom: 1rem;
            color: #1e5799;
        }
        
        .panel-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        
        .info-card {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 5px;
            border-left: 4px solid #1e5799;
        }
        
        .info-card h4 {
            margin-bottom: 0.5rem;
            color: #495057;
        }
        
        footer {
            background: #1e5799;
            color: white;
            padding: 2rem 0;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            nav ul {
                margin-top: 1rem;
                justify-content: center;
            }
            
            nav ul li {
                margin: 0 0.75rem;
            }
            
            .panel-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
const { useState, useEffect } = React;

function App() {
    const [activeUser, setActiveUser] = useState('manager');
    const [loggedIn, setLoggedIn] = useState(false);
    const [username, setUsername] = useState('');
    const [password, setPassword] = useState('');
    const [role, setRole] = useState('');

    const [buses, setBuses] = useState([]);
    const [students, setStudents] = useState([]);
    const [drivers, setDrivers] = useState([]);
    const [routes, setRoutes] = useState([]);
    const [notifications, setNotifications] = useState([]);
    const [alerts, setAlerts] = useState([]);

    // Dữ liệu mẫu
    useEffect(() => {
        setBuses([
            { id: 1, name: 'Xe 01', route: 'Tuyến A', driver: 'Nguyễn Văn A', status: 'Đang hoạt động', location: '12.345, 106.789' },
            { id: 2, name: 'Xe 02', route: 'Tuyến B', driver: 'Trần Thị B', status: 'Đang hoạt động', location: '12.356, 106.801' },
            { id: 3, name: 'Xe 03', route: 'Tuyến C', driver: 'Lê Văn C', status: 'Bảo trì', location: '12.340, 106.795' }
        ]);

        setStudents([
            { id: 1, name: 'Nguyễn Minh An', grade: 'Lớp 1A', bus: 'Xe 01', pickup: 'Điểm A1', status: 'Đã đón', parentPhone: '0123-456-789' },
            { id: 2, name: 'Trần Quốc Bảo', grade: 'Lớp 2B', bus: 'Xe 01', pickup: 'Điểm A2', status: 'Chưa đón', parentPhone: '0987-654-321' },
            { id: 3, name: 'Lê Thị Cẩm', grade: 'Lớp 3C', bus: 'Xe 02', pickup: 'Điểm B1', status: 'Đã đón', parentPhone: '0912-345-678' },
            { id: 4, name: 'Phạm Văn D', grade: 'Lớp 1A', bus: 'Xe 01', pickup: 'Điểm A3', status: 'Chưa đón', parentPhone: '0934-567-890' }
        ]);

        setDrivers([
            { id: 1, name: 'Nguyễn Văn A', phone: '0123-456-789', bus: 'Xe 01', status: 'Đang làm việc' },
            { id: 2, name: 'Trần Thị B', phone: '0987-654-321', bus: 'Xe 02', status: 'Đang làm việc' },
            { id: 3, name: 'Lê Văn C', phone: '0912-345-678', bus: 'Xe 03', status: 'Nghỉ phép' }
        ]);

        setRoutes([
            { id: 1, name: 'Tuyến A', stops: ['Điểm A1', 'Điểm A2', 'Điểm A3'], distance: '15km', duration: '45 phút' },
            { id: 2, name: 'Tuyến B', stops: ['Điểm B1', 'Điểm B2', 'Điểm B3'], distance: '12km', duration: '35 phút' },
            { id: 3, name: 'Tuyến C', stops: ['Điểm C1', 'Điểm C2', 'Điểm C3'], distance: '18km', duration: '50 phút' }
        ]);

        setNotifications([
            { id: 1, type: 'approaching', message: 'Xe buýt đang đến gần điểm đón của bé Nguyễn Minh An', time: '7:45 AM' },
            { id: 2, type: 'picked', message: 'Bé Lê Thị Cẩm đã được đón lên xe', time: '7:30 AM' }
        ]);

        setAlerts([
            { id: 1, type: 'delay', message: 'Xe 01 bị trễ 10 phút do tắc đường', time: '7:50 AM' }
        ]);
    }, []);

    // 3 tài khoản mẫu
    const accounts = [
        { username: 'manager', password: '123', role: 'manager' },
        { username: 'driver', password: '123', role: 'driver' },
        { username: 'parent', password: '123', role: 'parent' },
    ];

    // Xử lý đăng nhập
    const handleLogin = (e) => {
        e.preventDefault();
        const user = accounts.find(acc => acc.username === username && acc.password === password);
        if (user) {
            setRole(user.role);
            setActiveUser(user.role);
            setLoggedIn(true);
        } else {
            alert('Sai tên đăng nhập hoặc mật khẩu!');
        }
    };

    // Giao diện đăng nhập
    if (!loggedIn) {
        return (
            <div style={{
                display: 'flex',
                height: '100vh',
                justifyContent: 'center',
                alignItems: 'center',
                background: 'linear-gradient(135deg, #1e5799 0%, #207cca 100%)',
                color: 'white'
            }}>
                <div style={{
                    background: 'white',
                    color: '#333',
                    padding: '2rem 3rem',
                    borderRadius: '10px',
                    boxShadow: '0 4px 10px rgba(0,0,0,0.2)',
                    width: '350px',
                    textAlign: 'center'
                }}>
                    <h2 style={{ color: '#1e5799', marginBottom: '1rem' }}>Đăng nhập SSB 1.0</h2>
                    <form onSubmit={handleLogin}>
                        <div style={{ marginBottom: '1rem' }}>
                            <input 
                                type="text" 
                                placeholder="Tên đăng nhập" 
                                value={username} 
                                onChange={(e) => setUsername(e.target.value)} 
                                required
                                style={{ width: '100%', padding: '0.7rem', borderRadius: '5px', border: '1px solid #ccc' }}
                            />
                        </div>
                        <div style={{ marginBottom: '1rem' }}>
                            <input 
                                type="password" 
                                placeholder="Mật khẩu" 
                                value={password} 
                                onChange={(e) => setPassword(e.target.value)} 
                                required
                                style={{ width: '100%', padding: '0.7rem', borderRadius: '5px', border: '1px solid #ccc' }}
                            />
                        </div>
                        <button 
                            type="submit" 
                            style={{
                                width: '100%',
                                padding: '0.8rem',
                                background: '#1e5799',
                                color: 'white',
                                border: 'none',
                                borderRadius: '5px',
                                fontWeight: 'bold',
                                cursor: 'pointer'
                            }}
                        >
                            Đăng nhập
                        </button>
                    </form>
                    <p style={{ marginTop: '1rem', fontSize: '0.9rem' }}>
                        <strong>Tài khoản mẫu:</strong><br/>
                        Quản lý: manager / 123<br/>
                        Tài xế: driver / 123<br/>
                        Phụ huynh: parent / 123
                    </p>
                </div>
            </div>
        );
    }

    // Component bảng điều khiển Quản lý
    const ManagerDashboard = () => {
        const [activeTab, setActiveTab] = useState('overview');
        const [message, setMessage] = useState('');
        const [selectedRecipient, setSelectedRecipient] = useState('');

        const sendMessage = () => {
            if (message && selectedRecipient) {
                alert(`Tin nhắn đã gửi đến ${selectedRecipient}: ${message}`);
                setMessage('');
                setSelectedRecipient('');
            }
        };

        const updateLocation = (busId) => {
            alert(`Cập nhật vị trí cho xe ${busId}`);
        };

        return (
            <div>
                <h3 className="panel-title">Bảng điều khiển Quản lý</h3>
                <div style={{ marginBottom: '1rem' }}>
                    <button onClick={() => setActiveTab('overview')} style={{ marginRight: '0.5rem', padding: '0.5rem', background: activeTab === 'overview' ? '#1e5799' : '#ccc', color: 'white', border: 'none', borderRadius: '5px' }}>Tổng quan</button>
                    <button onClick={() => setActiveTab('lists')} style={{ marginRight: '0.5rem', padding: '0.5rem', background: activeTab === 'lists' ? '#1e5799' : '#ccc', color: 'white', border: 'none', borderRadius: '5px' }}>Danh sách</button>
                    <button onClick={() => setActiveTab('manage')} style={{ marginRight: '0.5rem', padding: '0.5rem', background: activeTab === 'manage' ? '#1e5799' : '#ccc', color: 'white', border: 'none', borderRadius: '5px' }}>Quản lý</button>
                    <button onClick={() => setActiveTab('messages')} style={{ padding: '0.5rem', background: activeTab === 'messages' ? '#1e5799' : '#ccc', color: 'white', border: 'none', borderRadius: '5px' }}>Tin nhắn</button>
                </div>

                {activeTab === 'overview' && (
                    <div className="panel-content">
                        <div className="info-card">
                            <h4>Tổng quan hệ thống</h4>
                            <p>Số xe buýt: {buses.length}</p>
                            <p>Số học sinh: {students.length}</p>
                            <p>Số tài xế: {drivers.length}</p>
                            <p>Số tuyến đường: {routes.length}</p>
                        </div>
                        <div className="info-card">
                            <h4>Xe buýt đang hoạt động</h4>
                            {buses.filter(bus => bus.status === 'Đang hoạt động').map(bus => (
                                <div key={bus.id}>
                                    <p><strong>{bus.name}</strong> - {bus.route} - Tài xế: {bus.driver}</p>
                                    <button onClick={() => updateLocation(bus.id)} style={{ padding: '0.3rem 0.5rem', background: '#28a745', color: 'white', border: 'none', borderRadius: '3px', cursor: 'pointer' }}>Cập nhật vị trí</button>
                                </div>
                            ))}
                        </div>
                    </div>
                )}

                {activeTab === 'lists' && (
                    <div>
                        <div className="info-card">
                            <h4>Danh sách Học sinh</h4>
                            {students.map(student => (
                                <p key={student.id}>{student.name} - {student.grade} - Xe: {student.bus} - Điểm đón: {student.pickup}</p>
                            ))}
                        </div>
                        <div className="info-card">
                            <h4>Danh sách Tài xế</h4>
                            {drivers.map(driver => (
                                <p key={driver.id}>{driver.name} - SĐT: {driver.phone} - Xe: {driver.bus} - Trạng thái: {driver.status}</p>
                            ))}
                        </div>
                        <div className="info-card">
                            <h4>Danh sách Xe buýt</h4>
                            {buses.map(bus => (
                                <p key={bus.id}>{bus.name} - Tuyến: {bus.route} - Tài xế: {bus.driver} - Trạng thái: {bus.status}</p>
                            ))}
                        </div>
                        <div className="info-card">
                            <h4>Danh sách Tuyến đường</h4>
                            {routes.map(route => (
                                <p key={route.id}>{route.name} - Khoảng cách: {route.distance} - Thời gian: {route.duration} - Điểm dừng: {route.stops.join(', ')}</p>
                            ))}
                        </div>
                    </div>
                )}

                {activeTab === 'manage' && (
                    <div className="panel-content">
                        <div className="info-card">
                            <h4>Tạo/Cập nhật Lịch trình</h4>
                            <button onClick={() => alert('Tạo lịch trình tuần')} style={{ padding: '0.5rem', background: '#007bff', color: 'white', border: 'none', borderRadius: '5px', cursor: 'pointer' }}>Tạo lịch trình tuần</button>
                            <button onClick={() => alert('Tạo lịch trình tháng')} style={{ padding: '0.5rem', marginLeft: '0.5rem', background: '#007bff', color: 'white', border: 'none', borderRadius: '5px', cursor: 'pointer' }}>Tạo lịch trình tháng</button>
                        </div>
                        <div className="info-card">
                            <h4>Phân công Tài xế và Xe</h4>
                            <button onClick={() => alert('Phân công tài xế cho tuyến')} style={{ padding: '0.5rem', background: '#ffc107', color: 'black', border: 'none', borderRadius: '5px', cursor: 'pointer' }}>Phân công tài xế</button>
                            <button onClick={() => alert('Phân công xe cho tuyến')} style={{ padding: '0.5rem', marginLeft: '0.5rem', background: '#ffc107', color: 'black', border: 'none', borderRadius: '5px', cursor: 'pointer' }}>Phân công xe</button>
                        </div>
                    </div>
                )}

                {activeTab === 'messages' && (
                    <div className="info-card">
                        <h4>Gửi Tin nhắn</h4>
                        <select value={selectedRecipient} onChange={(e) => setSelectedRecipient(e.target.value)} style={{ width: '100%', padding: '0.5rem', marginBottom: '0.5rem' }}>
                            <option value="">Chọn người nhận</option>
                            <option value="Tài xế">Tài xế</option>
                            <option value="Phụ huynh">Phụ huynh</option>
                        </select>
                        <textarea value={message} onChange={(e) => setMessage(e.target.value)} placeholder="Nhập tin nhắn..." style={{ width: '100%', padding: '0.5rem', marginBottom: '0.5rem' }}></textarea>
                        <button onClick={sendMessage} style={{ padding: '0.5rem', background: '#dc3545', color: 'white', border: 'none', borderRadius: '5px', cursor: 'pointer' }}>Gửi tin nhắn</button>
                    </div>
                )}
            </div>
        );
    };

    const DriverDashboard = () => {
        const driverStudents = students.filter(student => student.bus === 'Xe 01'); // Assuming driver is for Xe 01

        const reportPickup = (studentId) => {
            alert(`Đã báo cáo đón học sinh ${studentId}`);
        };

        const reportDropoff = (studentId) => {
            alert(`Đã báo cáo trả học sinh ${studentId}`);
        };

        const sendAlert = () => {
            alert('Đã gửi cảnh báo sự cố');
        };

        return (
            <div>
                <h3 className="panel-title">Bảng điều khiển Tài xế</h3>
                <div className="panel-content">
                    <div className="info-card">
                        <h4>Lịch làm việc hôm nay</h4>
                        <p>Tuyến đường: Tuyến A</p>
                        <p>Xe: Xe 01</p>
                        <p>Giờ bắt đầu: 6:30 AM</p>
                        <p>Giờ kết thúc dự kiến: 8:15 AM</p>
                    </div>
                    <div className="info-card">
                        <h4>Danh sách học sinh cần đón</h4>
                        {driverStudents.map(student => (
                            <div key={student.id}>
                                <p>{student.name} - Điểm đón: {student.pickup} - Trạng thái: {student.status}</p>
                                {student.status === 'Chưa đón' && (
                                    <button onClick={() => reportPickup(student.id)} style={{ padding: '0.3rem 0.5rem', background: '#28a745', color: 'white', border: 'none', borderRadius: '3px', cursor: 'pointer' }}>Báo cáo đón</button>
                                )}
                                {student.status === 'Đã đón' && (
                                    <button onClick={() => reportDropoff(student.id)} style={{ padding: '0.3rem 0.5rem', background: '#007bff', color: 'white', border: 'none', borderRadius: '3px', cursor: 'pointer' }}>Báo cáo trả</button>
                                )}
                            </div>
                        ))}
                    </div>
                </div>
                <div className="info-card" style={{ marginTop: '1rem' }}>
                    <h4>Gửi cảnh báo sự cố</h4>
                    <button onClick={sendAlert} style={{ padding: '0.5rem', background: '#dc3545', color: 'white', border: 'none', borderRadius: '5px', cursor: 'pointer' }}>Gửi cảnh báo</button>
                </div>
            </div>
        );
    };

    const ParentDashboard = () => {
        const childBus = buses.find(bus => bus.name === 'Xe 01'); // Assuming parent's child is on Xe 01

        return (
            <div>
                <h3 className="panel-title">Bảng điều khiển Phụ huynh</h3>
                <div className="info-card">
                    <h4>Xe của bé</h4>
                    <p>Xe 01 - Tuyến A - Tài xế: Nguyễn Văn A</p>
                    <p>Trạng thái: Đang di chuyển</p>
                </div>
                <div className="bus-map">
                    <p>Bản đồ theo dõi xe buýt (Mô phỏng)</p>
                    <p>Vị trí hiện tại: {childBus ? childBus.location : 'Không xác định'}</p>
                </div>
                <div className="info-card">
                    <h4>Thông báo</h4>
                    {notifications.map(notification => (
                        <p key={notification.id}>{notification.message} - {notification.time}</p>
                    ))}
                </div>
                <div className="info-card">
                    <h4>Cảnh báo</h4>
                    {alerts.map(alert => (
                        <p key={alert.id}>{alert.message} - {alert.time}</p>
                    ))}
                </div>
            </div>
        );
    };

    // Giao diện chính sau đăng nhập
    return (
        <div>
            <header>
                <div className="container header-content">
                    <div className="logo">SSB 1.0</div>
                    <button 
                        onClick={() => setLoggedIn(false)} 
                        style={{
                            background: 'white', 
                            color: '#1e5799', 
                            border: 'none', 
                            borderRadius: '5px', 
                            padding: '0.5rem 1rem', 
                            cursor: 'pointer', 
                            fontWeight: 'bold'
                        }}
                    >
                        Đăng xuất
                    </button>
                </div>
            </header>

            <section className="demo" style={{ paddingTop: '2rem' }}>
                <div className="container demo-content">
                    <div className="user-panel">
                        {role === 'manager' && <ManagerDashboard />}
                        {role === 'driver' && <DriverDashboard />}
                        {role === 'parent' && <ParentDashboard />}
                    </div>
                </div>
            </section>
        </div>
    );
}

// Render
ReactDOM.render(<App />, document.getElementById('root'));
</script>

</body>
</html>